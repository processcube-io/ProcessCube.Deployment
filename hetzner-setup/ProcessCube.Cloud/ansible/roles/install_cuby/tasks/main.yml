---
- name: Create processcube namespace
  shell: kubectl create namespace processcube --dry-run=client -o yaml | kubectl apply -f -
  changed_when: true

- name: Create ProcessCube Marketplace ImagePull Secret
  shell: |
    kubectl create secret docker-registry regcred \
      --docker-server=https://marketplace.processcube.io \
      --docker-username=processcube \
      --docker-password="{{ processcube_api_key }}" \
      -n processcube \
      --dry-run=client -o yaml | kubectl apply -f -
  changed_when: true

- name: Create ProcessCube API Key Secret
  shell: |
    kubectl create secret generic processcube-api-key \
      --from-literal=api-key="{{ processcube_api_key }}" \
      -n processcube \
      --dry-run=client -o yaml | kubectl apply -f -
  changed_when: true

- name: Display ProcessCube setup info
  debug:
    msg:
      - "ProcessCube secrets created in namespace 'processcube'"
      - ""
      - "Available secrets:"
      - "  - regcred (ImagePull Secret)"
      - "  - processcube-api-key (API Key Secret)"
